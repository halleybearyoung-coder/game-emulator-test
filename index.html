<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Fake Android Emulator — Web</title>
<style>
  :root{
    --bg:#0f1724; --surface:#0b1220; --accent:#1e90ff; --muted:#9aa6b2; --card:#0f1724;
  }
  *{box-sizing:border-box;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
  body{margin:16px; background:linear-gradient(180deg,#071026 0%, #041021 100%); color:#e6eef6}
  header{display:flex;align-items:center;gap:12px;margin-bottom:12px}
  h1{font-size:16px;margin:0}
  .wrap{display:flex;gap:12px}
  /* emulator container */
  .emu {
    width:360px; height:720px;
    background:linear-gradient(180deg,#0a1220 0,#071020 100%);
    border-radius:18px; padding:12px; position:relative;
    box-shadow: 0 20px 60px rgba(0,0,0,0.6), inset 0 1px 0 rgba(255,255,255,0.02);
    border:1px solid rgba(255,255,255,0.03);
  }
  .emu .statusbar{height:28px; display:flex;align-items:center;justify-content:space-between;padding:0 8px;color:var(--muted); font-size:12px;}
  .screen {
    background:linear-gradient(180deg,#071428 0,#062033 100%); margin-top:8px;
    border-radius:12px; overflow:hidden; height: calc(100% - 120px); display:flex; flex-direction:column;
  }
  .content {flex:1; display:flex; flex-direction:column; align-items:center; justify-content:flex-start; padding:16px}
  .dock {height:64px; display:flex; gap:10px; align-items:center; justify-content:center; padding:10px; border-top:1px solid rgba(255,255,255,0.02);}
  .icon {width:64px;height:64px;border-radius:14px;background:linear-gradient(180deg,#1f2937,#111827);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:20px;box-shadow:0 6px 18px rgba(0,0,0,0.5)}
  .grid {display:grid;grid-template-columns:repeat(4,1fr);gap:12px;width:100%;max-width:320px;margin-top:12px}
  .icon.small{width:56px;height:56px;border-radius:10px;font-size:14px}
  .label{font-size:12px;color:var(--muted);text-align:center;margin-top:6px}
  .controls{width:420px;padding:12px;border-radius:12px;background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.02)}
  button{background:var(--accent);border:none;color:#fff;padding:8px 12px;border-radius:8px;cursor:pointer}
  .muted{background:transparent;border:1px solid rgba(255,255,255,0.06);color:var(--muted);padding:8px 10px;border-radius:8px}
  .row{display:flex;gap:8px;align-items:center;margin-bottom:8px}
  .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.02); margin-bottom:10px}
  input[type="text"], input[type="url"]{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px;border-radius:8px;color:#e6eef6;flex:1}
  .store-list{max-height:240px;overflow:auto;padding:6px}
  .store-item{display:flex;gap:8px;align-items:center;padding:8px;border-radius:8px}
  .badge{background:rgba(255,255,255,0.03);padding:4px 6px;border-radius:6px;font-size:12px;color:var(--muted)}
  .smalltxt{font-size:12px;color:var(--muted)}
  .iframe-wrap{flex:1;border-radius:8px;overflow:hidden;background:#000;width:100%;}
  iframe {width:100%;height:100%;border:0}
  .topbar {display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
  .center{display:flex;flex-direction:column;align-items:center}
  .app-window {width:100%;height:100%;display:flex;flex-direction:column}
  .toast{position:absolute;left:50%;transform:translateX(-50%);bottom:86px;background:rgba(0,0,0,0.6);padding:8px 12px;border-radius:12px;color:#fff;font-size:13px}
  .rotate{transform:rotate(90deg)}
  .info{font-size:12px;color:var(--muted)}
  footer{margin-top:12px;color:var(--muted);font-size:13px}
</style>
</head>
<body>
<header>
  <h1>Fake Android Emulator</h1>
  <div class="info">Quick demo — installs web apps & records APK metadata (no native app execution)</div>
</header>
<div class="wrap">
  <div class="emu" id="emu">
    <div class="statusbar">
      <div>Fake-Device</div>
      <div id="clock"></div>
    </div>

    <div class="screen" id="screen">
      <div class="content" id="home">
        <div class="topbar" style="width:100%;max-width:360px;">
          <div class="smalltxt">Home</div>
          <div>
            <button class="muted" id="openStore">Play Store</button>
            <button class="muted" id="openDrawer">Apps</button>
          </div>
        </div>

        <div class="grid" id="grid">
          <!-- icons injected -->
        </div>

        <div style="flex:1"></div>

        <div class="dock" id="dock">
          <!-- dock icons -->
        </div>
      </div>

      <div id="appArea" style="display:none;height:100%;width:100%">
        <div class="app-window">
          <div class="topbar" style="padding:8px">
            <button class="muted" id="backHome">← Home</button>
            <div id="appTitle" class="smalltxt">App</div>
            <div style="display:flex;gap:8px">
              <button class="muted" id="rotateBtn">Rotate</button>
              <button class="muted" id="uninstallBtn">Uninstall</button>
            </div>
          </div>
          <div class="iframe-wrap" id="appFrameWrap">
            <iframe id="appFrame" srcdoc="<div style='color:#fff;background:#0a1220;height:100%;display:flex;align-items:center;justify-content:center;font-family:Inter,sans-serif'>No app loaded</div>"></iframe>
          </div>
        </div>
      </div>

    </div>

    <div class="card" style="margin-top:8px">
      <div style="display:flex;gap:8px;align-items:center;justify-content:space-between">
        <div class="smalltxt">Emulator controls</div>
        <div style="display:flex;gap:8px">
          <label class="smalltxt">Scale
            <select id="scale" style="margin-left:6px">
              <option value="1">1×</option><option value="1.2" selected>1.2×</option><option value="1.5">1.5×</option>
            </select>
          </label>
          <button id="screenshot" class="muted">Screenshot</button>
        </div>
      </div>
    </div>

    <div style="height:8px"></div>
  </div>

  <div class="controls" id="controls">
    <div class="card">
      <div class="row">
        <div style="font-weight:700">Fake Play Store</div>
      </div>

      <div class="row">
        <input type="text" id="search" placeholder="Search (mock catalog) — try 'weather' or 'puzzle'"/>
        <button id="doSearch" class="muted">Search</button>
      </div>

      <div class="store-list card" id="storeList">
        <!-- store items -->
      </div>

      <div class="row">
        <input type="url" id="urlInput" placeholder="Install web app from URL (https://...)"/>
        <button id="installUrl">Install</button>
      </div>

      <div class="row">
        <label class="muted" style="padding:8px">Drag & drop an APK anywhere on this page to 'install' (metadata only)</label>
      </div>

      <hr style="border:none;height:1px;background:rgba(255,255,255,0.03);margin:8px 0"/>

      <div class="row">
        <div style="font-weight:700">Installed Apps</div>
        <div style="flex:1"></div>
        <button id="clearAll" class="muted">Clear</button>
      </div>

      <div id="installedList" style="max-height:220px;overflow:auto;padding:6px"></div>
    </div>

    <div style="width:100%;margin-top:12px">
      <div class="card smalltxt">
        <div style="font-weight:700;margin-bottom:6px">How this works</div>
        <ul>
          <li>Web apps (URLs) are opened in an iframe inside the emulator.</li>
          <li>APK files dropped into the page are parsed for filename/size and added to your installed list (<em>they are not executed</em>).</li>
          <li>Apps persist using localStorage — reload keeps the installed apps.</li>
        </ul>
      </div>
    </div>

  </div>
</div>

<div id="toast" class="toast" style="display:none">Installed</div>

<script>
/* ------- Fake Android Emulator JS ------- */
const sampleStore = [
  {id:'weather.pro', name:'Weather Pro', desc:'Fast forecast & radar', icon:'W', url:'https://wttr.in/?format=3'},
  {id:'puzz.fun', name:'Puzzle Fun', desc:'Retro logic puzzles', icon:'P', url:'https://www.coolmathgames.com/0-circuit-beads'},
  {id:'notes.web', name:'Notes', desc:'Simple note-taking app', icon:'N', url:'data:text/html,<html><body style="font-family:Inter,Arial;background:#0a1220;color:#fff;display:flex;align-items:center;justify-content:center;height:100%"><textarea style="width:90%;height:80%;font-size:16px"></textarea></body></html>'},
  {id:'music.web', name:'Music Player', desc:'Plays online streams', icon:'M', url:'https://music.youtube.com/'},
  {id:'news.web', name:'Quick News', desc:'Latest headlines', icon:'Q', url:'https://news.google.com/'}
];

const EMU = document.getElementById('emu');
const grid = document.getElementById('grid');
const dock = document.getElementById('dock');
const storeList = document.getElementById('storeList');
const installedList = document.getElementById('installedList');
const appArea = document.getElementById('appArea');
const appFrame = document.getElementById('appFrame');
const appTitle = document.getElementById('appTitle');
const backHome = document.getElementById('backHome');
const openStore = document.getElementById('openStore');
const openDrawer = document.getElementById('openDrawer');
const openToast = (t)=>{const el=document.getElementById('toast');el.textContent=t;el.style.display='block';setTimeout(()=>el.style.display='none',1800)};

let apps = JSON.parse(localStorage.getItem('fake_emu_apps') || '[]'); // {id,name,icon,url,type: 'web'|'apk',meta}
let dockIds = JSON.parse(localStorage.getItem('fake_emu_dock') || '["weather.pro","notes.web","music.web"]');

function save(){
  localStorage.setItem('fake_emu_apps', JSON.stringify(apps));
  localStorage.setItem('fake_emu_dock', JSON.stringify(dockIds));
}

function nowTime(){
  const d=new Date(); return d.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
}

document.getElementById('clock').textContent = nowTime();
setInterval(()=>document.getElementById('clock').textContent = nowTime(),60000);

// init store view
function renderStore(list){
  storeList.innerHTML = '';
  list.forEach(s=>{
    const item = document.createElement('div'); item.className='store-item';
    item.innerHTML = `<div class="icon small">${s.icon}</div>
      <div style="flex:1">
        <div style="font-weight:700">${s.name}</div>
        <div class="smalltxt">${s.desc}</div>
      </div>
      <div style="display:flex;flex-direction:column;gap:6px">
        <button class="muted" data-id="${s.id}" data-url="${s.url}">Install</button>
        <div class="badge">free</div>
      </div>`;
    storeList.appendChild(item);
    item.querySelector('button').addEventListener('click', ()=>{
      installWebApp({id:s.id,name:s.name,icon:s.icon,url:s.url,type:'web'});
    });
  });
}
renderStore(sampleStore);

// installed apps list render
function renderInstalled(){
  grid.innerHTML = '';
  installedList.innerHTML = '';
  // grid icons
  apps.forEach(a=>{
    const el = document.createElement('div'); el.style.display='flex'; el.style.flexDirection='column'; el.style.alignItems='center';
    el.innerHTML = `<div class="icon" data-id="${a.id}" title="${a.name}">${a.icon||a.name[0]||'A'}</div><div class="label">${a.name}</div>`;
    grid.appendChild(el);
    el.querySelector('.icon').addEventListener('click', ()=>openApp(a.id));
  });
  // dock
  dock.innerHTML = '';
  dockIds.forEach(id=>{
    const a = apps.find(x=>x.id===id);
    if (!a) return;
    const d = document.createElement('div'); d.style.display='flex'; d.style.flexDirection='column'; d.style.alignItems='center';
    d.innerHTML = `<div class="icon small" data-id="${a.id}">${a.icon||a.name[0]}</div>`;
    dock.appendChild(d);
    d.querySelector('.icon').addEventListener('click', ()=>openApp(a.id));
  });

  // installed list detail
  apps.forEach(a=>{
    const row = document.createElement('div'); row.className='store-item';
    const meta = a.meta ? `<div class="smalltxt">${a.meta}</div>` : '';
    row.innerHTML = `<div style="display:flex;gap:8px;align-items:center"><div class="icon small">${a.icon||a.name[0]}</div>
      <div style="min-width:160px"><div style="font-weight:700">${a.name}</div>${meta}</div></div>
      <div style="display:flex;flex-direction:column;gap:6px">
        <button class="muted" data-id="${a.id}">Open</button>
        <button class="muted" data-un="${a.id}">Uninstall</button>
      </div>`;
    installedList.appendChild(row);
    row.querySelector('button[data-id]').addEventListener('click', ()=>openApp(a.id));
    row.querySelector('button[data-un]').addEventListener('click', ()=>{ uninstallApp(a.id); });
  });
}

function installWebApp(app){
  // avoid duplicates
  if (apps.find(a=>a.id===app.id)){
    openToast('App already installed');
    return;
  }
  apps.push(app);
  save();
  renderInstalled();
  openToast('Installed ' + app.name);
}

function installApkMeta(meta){
  // meta: {id,name,icon,type:'apk',meta:'filename (size)'}
  if (apps.find(a=>a.id===meta.id)){
    openToast('APK already recorded');
    return;
  }
  apps.push(meta);
  save();
  renderInstalled();
  openToast('APK added: ' + meta.name);
}

function uninstallApp(id){
  apps = apps.filter(a=>a.id!==id);
  dockIds = dockIds.filter(x=>x!==id);
  save();
  renderInstalled();
  openToast('Uninstalled');
}

function openApp(id){
  const a = apps.find(x=>x.id===id);
  if (!a) return openToast('App not found');
  document.getElementById('home').style.display='none';
  appArea.style.display='block';
  appTitle.textContent = a.name;
  if (a.type === 'web' && a.url){
    // load URL into iframe (for data: URLs or normal)
    appFrame.src = a.url;
  } else {
    // show metadata page for APKs
    const html = `<div style="color:#fff;background:#0a1220;height:100%;display:flex;align-items:center;justify-content:center;font-family:Inter,sans-serif;padding:20px">
      <div style="max-width:360px">
        <h2>${a.name}</h2>
        <p class="smalltxt">Type: ${a.type}</p>
        <p class="smalltxt">${a.meta||'No extra metadata'}</p>
        <div style="margin-top:12px"><button id="fakerun" class="muted">Open metadata</button></div>
      </div>
    </div>`;
    appFrame.srcdoc = html;
  }
}

document.getElementById('backHome').addEventListener('click', ()=>{
  appArea.style.display='none';
  document.getElementById('home').style.display='flex';
});

// store search
document.getElementById('doSearch').addEventListener('click', ()=>{
  const q = document.getElementById('search').value.trim().toLowerCase();
  if (!q) renderStore(sampleStore);
  else renderStore(sampleStore.filter(s=> (s.name+s.desc).toLowerCase().includes(q) ));
});

// install URL
document.getElementById('installUrl').addEventListener('click', ()=>{
  const val = document.getElementById('urlInput').value.trim();
  if (!val) return openToast('Enter a URL');
  const id = 'webapp_'+Math.random().toString(36).slice(2,9);
  const name = new URL(val).hostname.replace('www.','') || 'Web App';
  const icon = name[0].toUpperCase();
  installWebApp({id,name,icon,url:val,type:'web'});
  document.getElementById('urlInput').value='';
});

// open store / drawer
openStore.addEventListener('click', ()=>{ renderStore(sampleStore); openToast('Store opened'); });
openDrawer.addEventListener('click', ()=>{ document.getElementById('home').style.display='flex'; openToast('App drawer'); });

// uninstall button in app
document.getElementById('uninstallBtn').addEventListener('click', ()=>{
  const id = apps.find(a=>a.name===appTitle.textContent)?.id;
  if (id) uninstallApp(id);
});

// rotate button
let rotated=false;
document.getElementById('rotateBtn').addEventListener('click', ()=>{
  const s = document.getElementById('screen');
  rotated = !rotated;
  if (rotated){
    s.style.transform = 'rotate(90deg) scale(1.25)';
  } else s.style.transform = 'none';
});

// screenshot
document.getElementById('screenshot').addEventListener('click', ()=>{
  html2canvas = null;
  // simple approach: create image from iframe by drawing a fallback snapshot
  openToast('Screenshot saved to clipboard not supported in demo');
});

// clear all
document.getElementById('clearAll').addEventListener('click', ()=>{
  if (!confirm('Clear all installed apps?')) return;
  apps=[]; dockIds=[]; save(); renderInstalled();
});

// handle APK drag & drop (metadata only)
window.addEventListener('dragover', e=>{ e.preventDefault(); });
window.addEventListener('drop', e=>{
  e.preventDefault();
  const f = e.dataTransfer.files && e.dataTransfer.files[0];
  if (!f) return;
  // read name/size only, no execution
  const meta = { id:'apk_'+Math.random().toString(36).slice(2,9), name: f.name.replace(/\.[^.]+$/,''), icon:'A', type:'apk', meta: `${f.name} — ${Math.round(f.size/1024)} KB` };
  installApkMeta(meta);
});

// allow click-to-add sample apps quickly
function addDefaultIfEmpty(){
  if (apps.length===0){
    sampleStore.slice(0,3).forEach(s=>apps.push({...s}));
    save();
  }
}
addDefaultIfEmpty();
renderInstalled();

// scale control
document.getElementById('scale').addEventListener('change', (e)=>{
  const v = parseFloat(e.target.value);
  EMU.style.transform = `scale(${v})`;
  EMU.style.transformOrigin = 'top left';
});

// simple keyboard mapping: backspace -> home
window.addEventListener('keydown', (e)=>{
  if (e.key === 'Escape') {
    appArea.style.display='none';
    document.getElementById('home').style.display='flex';
  }
});

// screenshot note: you can use browser devtools to capture element if you want a true screenshot.

</script>
</body>
</html>
